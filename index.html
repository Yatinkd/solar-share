<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>SolarShare — Submit Rooftop (Client-only)</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body{background:#f7faf7;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;padding:28px}
  .card{border-radius:12px;box-shadow:0 12px 30px rgba(15,23,42,0.06)}
  .brand{color:#0d6f3a;font-weight:800}
  .muted{color:#6b7280}
  .help{font-size:.9rem;color:#475569}
</style>
</head>
<body>
<div class="container" style="max-width:900px">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div><div class="brand">SolarShare</div><div class="muted">Quick rooftop suitability analyzer — client-only</div></div>
    <a href="results.html" class="btn btn-outline-secondary btn-sm">View last result</a>
  </div>

  <div class="card p-4 mb-3">
    <h5>Enter rooftop details</h5>
    <p class="help">No backend. Everything is calculated in your browser and shown on the result page.</p>

    <form id="submitForm" class="row g-3">
      <div class="col-md-6"><label class="form-label">Your name</label><input id="owner" required class="form-control" placeholder="e.g. Ravi"></div>
      <div class="col-md-6"><label class="form-label">Area (sq.ft)</label><input id="area" type="number" required class="form-control" placeholder="e.g. 200"></div>
      <div class="col-md-6"><label class="form-label">Location (city / pincode)</label><input id="location" required class="form-control" placeholder="Bengaluru, 560001"></div>
      <div class="col-md-3"><label class="form-label">Avg sun hours/day</label><input id="sunHours" type="number" step="0.1" class="form-control" value="5.5"></div>
      <div class="col-md-3"><label class="form-label">Shade</label><select id="shade" class="form-select"><option value="no">No</option><option value="partial">Partial</option><option value="yes">Yes</option></select></div>

      <div class="col-12">
        <div id="msg"></div>
        <div class="d-flex gap-2">
          <button class="btn btn-success" type="submit">Analyze & Show Results</button>
          <button id="demoBtn" type="button" class="btn btn-outline-primary">Fill demo data</button>
        </div>
      </div>
    </form>
  </div>

  <div class="text-muted small">This is a demo: nothing is stored. If you later want to save submissions to Google Sheets, I can give the Apps Script code.</div>
</div>

<script>
/* CLIENT-SIDE CALC (no backend) */
function areaToKW(area){ return Math.max(0.5, (area/100)*1.5); } // 100 sq.ft -> ~1.5 kW
function annualKWh(kw,sun){ return Math.round(kw * sun * 365 * 0.75); } // PR 0.75
function kWhToCO2(kwh){ return Math.round((kwh * 0.82)/1000 * 100)/100; } // tonnes/yr
function computeScore(area, sunHours, shade){
  let score = 50;
  score += Math.min(30, sunHours * 5);
  score += Math.min(20, (area/100) * 2);
  if (shade === 'no') score += 10;
  if (shade === 'partial') score += 0;
  if (shade === 'yes') score -= 15;
  return Math.max(0, Math.min(100, Math.round(score)));
}

const form = document.getElementById('submitForm');
const msg = document.getElementById('msg');

form.addEventListener('submit', (e)=>{
  e.preventDefault();
  const owner = document.getElementById('owner').value.trim();
  const area = Number(document.getElementById('area').value);
  const location = document.getElementById('location').value.trim();
  const sunHours = Number(document.getElementById('sunHours').value);
  const shade = document.getElementById('shade').value;

  if(!owner || !area || !location){ setMsg('Please fill required fields','warning'); return; }

  // compute locally
  const kw = areaToKW(area);
  const annual = annualKWh(kw, sunHours);
  const co2 = kWhToCO2(annual);
  const score = computeScore(area, sunHours, shade);

  // estimate money saved (example tariff)
  const tariff = 9; // ₹ per kWh (change if you want)
  const money = Math.round(annual * tariff);

  // redirect to results page with params (no storage anywhere)
  const params = new URLSearchParams({
    owner: owner,
    location: location,
    area: area,
    kw: kw,
    kwh: annual,
    co2: co2,
    money: money,
    lat: '', // optional: we don't geocode here
    lng: '',
    suit: score
  });
  setMsg('Calculated — opening result page...','success');
  setTimeout(()=> window.location.href = 'results.html?' + params.toString(), 600);
});

function setMsg(text, kind){
  const color = kind==='success' ? 'success' : kind==='danger' ? 'danger' : kind==='warning' ? 'warning' : 'info';
  msg.innerHTML = `<div class="alert alert-${color}">${text}</div>`;
}

document.getElementById('demoBtn').addEventListener('click', ()=>{
  document.getElementById('owner').value = 'Anita';
  document.getElementById('area').value = 180;
  document.getElementById('location').value = 'Chennai, 600001';
  document.getElementById('sunHours').value = 5.8;
  document.getElementById('shade').value = 'partial';
  setMsg('Demo data filled. Click Analyze & Show Results','info');
});
</script>
</body>
</html>
